<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9"/>
<title>ZWSoft ZRX for ZWCAD: Developer Guide: Extension Dictionary</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">ZWSoft ZRX for ZWCAD: Developer Guide
   &#160;<span id="projectnumber">2022</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Extension Dictionary<div class="ingroups"><a class="el" href="group___zrx_intro_conc.html">ZRX Introductory Concepts</a> &raquo; <a class="el" href="group___d_b_obj.html">Database Objects</a> &raquo; <a class="el" href="group___d_b_obj_add_data.html">Adding Object-Specific Data</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>The extension dictionary is associated with a specific entity, but an entity does not contain an extension dictionary by default. If you want to use the extension dictionary to hold the data associated with the entity, you can use the createExtensionDictionary function to create an extension dictionary for the entity, if the entity already contains an extension dictionary Function calls do not have any effect. <br />
 <br />
 After creating the extension dictionary, you can use the extensionDictionary() function to get the entity's extension dictionary. The setAt function of the AcDbDictionary object can add an element to the dictionary, either AcDbXrecord or other type of object. If you add AcDbXrecord, you can use the acutBuildList() function to build a result buffer list that holds the data, and then use the setFromRbChain() function to add the resulting buffer list to the extension and record. </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> DBObjects::AddXRecord()</div>
<div class="line">{</div>
<div class="line">    ads_name en;</div>
<div class="line">    ads_point pt;</div>
<div class="line">    <span class="keywordflow">if</span>(acedEntSel(_T(<span class="stringliteral">&quot;\nSelect the entity you want to add XRecord data&quot;</span>),en,pt) != RTNORM)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    AcDbObjectId entId;</div>
<div class="line">    Acad::ErrorStatus es = acdbGetObjectId(entId,en);</div>
<div class="line"></div>
<div class="line">    AcDbXrecord* pXrec = <span class="keyword">new</span> AcDbXrecord;</div>
<div class="line">    AcDbObject* pObj;</div>
<div class="line">    AcDbObjectId dictObjId,xRecObjId;</div>
<div class="line">    AcDbDictionary* pDict;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>resbuf* pRb;</div>
<div class="line">    acdbOpenObject(pObj,entId,AcDb::kForWrite);</div>
<div class="line">    pObj-&gt;createExtensionDictionary();</div>
<div class="line">    dictObjId = pObj-&gt;extensionDictionary();</div>
<div class="line">    pObj-&gt;close();</div>
<div class="line"></div>
<div class="line">    acdbOpenObject(pDict,dictObjId,AcDb::kForWrite);</div>
<div class="line">    pDict-&gt;setAt(_T(<span class="stringliteral">&quot;XRecord&quot;</span>),pXrec,xRecObjId);</div>
<div class="line">    pDict-&gt;close();</div>
<div class="line"></div>
<div class="line">    pRb = acutBuildList(AcDb::kDxfText,_T(<span class="stringliteral">&quot;\n Line&quot;</span>),</div>
<div class="line">        AcDb::kDxfInt32,12,</div>
<div class="line">        AcDb::kDxfReal,3.14,</div>
<div class="line">        AcDb::kDxfXCoord,pt,</div>
<div class="line">        RTNONE);</div>
<div class="line">    pXrec-&gt;setFromRbChain(*pRb);</div>
<div class="line">    pXrec-&gt;close();</div>
<div class="line">    acutRelRb(pRb);</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment --><p>If you want to access the extension records saved in the entity extension dictionary, you can use the extensionDictionary () function to get the entity's extension dictionary, and then get the specified element (extension record) through the getAt () function, using AcDbXrecord :: rbChain () to get The result of the data buffer list. </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> DBObjects::PrintXRecord ()</div>
<div class="line">{</div>
<div class="line">    ads_name en;</div>
<div class="line">    ads_point pt;</div>
<div class="line">    <span class="keywordflow">if</span>(acedEntSel(_T(<span class="stringliteral">&quot;\nSelect the XRecord data entity to view:&quot;</span>),en,pt) != RTNORM)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    </div>
<div class="line">    AcDbObjectId entId;</div>
<div class="line">    Acad::ErrorStatus es = acdbGetObjectId(entId,en);</div>
<div class="line"></div>
<div class="line">    AcDbEntity* pEnt;</div>
<div class="line">    acdbOpenAcDbEntity(pEnt,entId,AcDb::kForRead);</div>
<div class="line">    AcDbObjectId dictObjId = pEnt-&gt;extensionDictionary();</div>
<div class="line">    pEnt-&gt;close();</div>
<div class="line">    <span class="keywordflow">if</span>(dictObjId == AcDbObjectId::kNull)</div>
<div class="line">    {</div>
<div class="line">        acutPrintf(_T(<span class="stringliteral">&quot;\n The selected entity does not contain an extension dictionary.&quot;</span>));</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    AcDbDictionary* pDict;</div>
<div class="line">    AcDbXrecord* pXrec;</div>
<div class="line">    acdbOpenObject(pDict,dictObjId,AcDb::kForRead);</div>
<div class="line">    pDict-&gt;getAt(_T(<span class="stringliteral">&quot;XRecord&quot;</span>),(AcDbObject* &amp;)pXrec,AcDb::kForRead);</div>
<div class="line">    pDict-&gt;close();</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>resbuf* pRb;</div>
<div class="line">    pXrec-&gt;rbChain(&amp;pRb);</div>
<div class="line">    pXrec-&gt;close();</div>
<div class="line">    <span class="keywordflow">if</span>(pRb != NULL)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">struct </span>resbuf* pTemp;</div>
<div class="line">        pTemp = pRb;</div>
<div class="line">        acutPrintf(_T(<span class="stringliteral">&quot;\n String type data extension：%s&quot;</span>),pTemp-&gt;resval.rstring);</div>
<div class="line">        pTemp = pTemp-&gt;rbnext;</div>
<div class="line">        acutPrintf(_T(<span class="stringliteral">&quot;\n Integer type data extension：%d&quot;</span>),pTemp-&gt;resval.rint);</div>
<div class="line">        pTemp = pTemp-&gt;rbnext;</div>
<div class="line">        acutPrintf(_T(<span class="stringliteral">&quot;\n Real number type data extension：%.2f&quot;</span>),pTemp-&gt;resval.rreal);</div>
<div class="line">        pTemp = pTemp-&gt;rbnext;</div>
<div class="line">        acutPrintf(_T(<span class="stringliteral">&quot;\n Point type data extension：%.2f,%.2f,%.2f&quot;</span>),pTemp-&gt;resval.rpoint[X],pTemp-&gt;resval.rpoint[Y],pTemp-&gt;resval.rpoint[Z]);</div>
<div class="line">        acutRelRb(pRb);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        acutPrintf(_T(<span class="stringliteral">&quot;\n Did not find its extended data&quot;</span>));</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<hr class="footer"/><address class="footer"><small>
<a href="https://www.zwsoft.com/zwcad/Developers/">
<img class="footer" src="zwsoft.png" alt="zwsoft"/></br>
</a>
&copy; 1998-2022  Copyright ZWSOFT CO., LTD(Guangzhou)</br>
All rights reserved.
</small></address>
</body>
</html>

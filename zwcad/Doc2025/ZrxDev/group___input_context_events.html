<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ZWSoft ZRX for ZWCAD: Developer Guide: Input Context Events</title>
<link href="../styles/tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../scripts/jquery.js"></script>
<script type="text/javascript" src="../scripts/dynsections.js"></script>
<link href="../styles/doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../pics/logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ZWSoft ZRX for ZWCAD: Developer Guide
   &#160;<span id="projectnumber">2024</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Input Context Events<div class="ingroups"><a class="el" href="group___advanced_topics.html">Advanced Topics</a> &raquo; <a class="el" href="group___input_pnt_proc.html">Input Point Processing</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>The following example demonstrates creating a input context reactor. </p><div class="fragment"><div class="line"><span class="keyword">class </span>ZsdkContextReactor : <span class="keyword">public</span> AcEdInputContextReactor</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> </div><div class="line">        beginGetPoint(</div><div class="line">        <span class="keyword">const</span> AcGePoint3d* pIn,</div><div class="line">        <span class="keyword">const</span> ACHAR* promptString,</div><div class="line">        <span class="keywordtype">int</span> initGetFlags,</div><div class="line">        <span class="keyword">const</span> ACHAR* pKeywords);</div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> </div><div class="line">        endGetPoint(</div><div class="line">        Acad::PromptStatus returnStatus,</div><div class="line">        <span class="keyword">const</span> AcGePoint3d&amp; pointOut,</div><div class="line">        <span class="keyword">const</span> ACHAR*&amp; pKeyword);</div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> </div><div class="line">        beginGetOrientation(</div><div class="line">        <span class="keyword">const</span> AcGePoint3d* pointIn,</div><div class="line">        <span class="keyword">const</span> ACHAR* promptString,</div><div class="line">        <span class="keywordtype">int</span> initGetFlags,</div><div class="line">        <span class="keyword">const</span> ACHAR* pKeywords);</div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> </div><div class="line">        endGetOrientation(</div><div class="line">        Acad::PromptStatus returnStatus,</div><div class="line">        <span class="keywordtype">double</span>&amp; angle,</div><div class="line">        <span class="keyword">const</span> ACHAR*&amp; pKeyword);</div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> </div><div class="line">        beginGetCorner(</div><div class="line">        <span class="keyword">const</span> AcGePoint3d* firstCorner,</div><div class="line">        <span class="keyword">const</span> ACHAR* promptString,</div><div class="line">        <span class="keywordtype">int</span> initGetFlags,</div><div class="line">        <span class="keyword">const</span> ACHAR* pKeywords);</div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> </div><div class="line">        endGetCorner(</div><div class="line">        Acad::PromptStatus returnStatus,</div><div class="line">        AcGePoint3d&amp; secondCorner,</div><div class="line">        <span class="keyword">const</span> ACHAR*&amp; pKeyword);</div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> </div><div class="line">        beginSSGet(</div><div class="line">        <span class="keyword">const</span> ACHAR*  pPrompt,</div><div class="line">        <span class="keywordtype">int</span>          initGetFlags,</div><div class="line">        <span class="keyword">const</span> ACHAR*  pKeywords,</div><div class="line">        <span class="keyword">const</span> ACHAR*  pSSControls,</div><div class="line">        <span class="keyword">const</span> AcArray&lt;AcGePoint3d&gt;&amp; points,</div><div class="line">        <span class="keyword">const</span> resbuf* entMask);</div><div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> </div><div class="line">        endSSGet(</div><div class="line">        Acad::PromptStatus returnStatus,</div><div class="line">        <span class="keyword">const</span> AcArray&lt;AcDbObjectId&gt;&amp; ss);</div><div class="line">};</div><div class="line"><span class="keywordtype">void</span></div><div class="line">    ZsdkContextReactor::beginGetPoint(</div><div class="line">    <span class="keyword">const</span> AcGePoint3d* pointIn,</div><div class="line">    <span class="keyword">const</span> ACHAR* promptString,</div><div class="line">    <span class="keywordtype">int</span>   initGetFlags,</div><div class="line">    <span class="keyword">const</span> ACHAR* pKeywords)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (pointIn == NULL) <span class="keywordflow">return</span>;</div><div class="line">    acutPrintf(TEXT(<span class="stringliteral">&quot;beginGetPoint: pointIn = %.2f,%.2f,%.2f\n&quot;</span>),</div><div class="line">        (*pointIn)[0], (*pointIn)[1], (*pointIn)[2]);</div><div class="line">}</div><div class="line"><span class="keywordtype">void</span></div><div class="line">    ZsdkContextReactor::endGetPoint(</div><div class="line">    Acad::PromptStatus returnStatus,</div><div class="line">    <span class="keyword">const</span> AcGePoint3d&amp; pointOut,</div><div class="line">    <span class="keyword">const</span> ACHAR*&amp; pKeyword)</div><div class="line">{</div><div class="line">    acutPrintf(TEXT(<span class="stringliteral">&quot;endGetPoint: pointOut =%.2f,%.2f,%.2f\n&quot;</span>), pointOut[0], pointOut[1],</div><div class="line">        pointOut[2]);</div><div class="line">}</div><div class="line"><span class="keywordtype">void</span></div><div class="line">    ZsdkContextReactor::beginGetOrientation(</div><div class="line">    <span class="keyword">const</span> AcGePoint3d* pointIn,</div><div class="line">    <span class="keyword">const</span> ACHAR* promptString,</div><div class="line">    <span class="keywordtype">int</span>   initGetFlags,</div><div class="line">    <span class="keyword">const</span> ACHAR* pKeywords)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (pointIn == NULL) <span class="keywordflow">return</span>;</div><div class="line">    acutPrintf(TEXT(<span class="stringliteral">&quot;beginGetOrientation: %.2f, %.2f, %.2f\n&quot;</span>),</div><div class="line">        (*pointIn)[0], (*pointIn)[1], (*pointIn)[2]);</div><div class="line">}</div><div class="line"><span class="keywordtype">void</span></div><div class="line">    ZsdkContextReactor::endGetOrientation(</div><div class="line">    Acad::PromptStatus returnStatus, </div><div class="line">    <span class="keywordtype">double</span>&amp; angle, </div><div class="line">    <span class="keyword">const</span> ACHAR*&amp; pKeyword)</div><div class="line">{</div><div class="line">    acutPrintf(TEXT(<span class="stringliteral">&quot;endGetOrientation: %.2f\n&quot;</span>), angle);</div><div class="line">}</div><div class="line"><span class="keywordtype">void</span></div><div class="line">    ZsdkContextReactor::beginGetCorner(</div><div class="line">    <span class="keyword">const</span> AcGePoint3d* firstCorner,</div><div class="line">    <span class="keyword">const</span> ACHAR* promptString,</div><div class="line">    <span class="keywordtype">int</span>   initGetFlags,</div><div class="line">    <span class="keyword">const</span> ACHAR* pKeywords)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (NULL != firstCorner)</div><div class="line">    {</div><div class="line">        acutPrintf(</div><div class="line">            TEXT(<span class="stringliteral">&quot;beginGetCorner: %.2f, %.2f, %.2f\n&quot;</span>),</div><div class="line">            (*firstCorner)[0], </div><div class="line">            (*firstCorner)[1], </div><div class="line">            (*firstCorner)[2]);</div><div class="line">    }</div><div class="line">}</div><div class="line"><span class="keywordtype">void</span></div><div class="line">    ZsdkContextReactor::endGetCorner(</div><div class="line">    Acad::PromptStatus returnStatus,</div><div class="line">    AcGePoint3d&amp; secondCorner,</div><div class="line">    <span class="keyword">const</span> ACHAR*&amp; pKeyword)</div><div class="line">{</div><div class="line"></div><div class="line">    acutPrintf(</div><div class="line">        TEXT(<span class="stringliteral">&quot;endGetCorner: %.2f, %.2f, %.2f\n&quot;</span>),</div><div class="line">        (secondCorner)[0], </div><div class="line">        (secondCorner)[1], </div><div class="line">        (secondCorner)[2]);</div><div class="line">}</div><div class="line"><span class="keywordtype">void</span></div><div class="line">    ZsdkContextReactor::beginSSGet(</div><div class="line">    <span class="keyword">const</span> ACHAR*  pPrompt,</div><div class="line">    <span class="keywordtype">int</span>          initGetFlags,</div><div class="line">    <span class="keyword">const</span> ACHAR*  pKeywords,</div><div class="line">    <span class="keyword">const</span> ACHAR*  pSSControls,</div><div class="line">    <span class="keyword">const</span> AcArray&lt;AcGePoint3d&gt;&amp; points,</div><div class="line">    <span class="keyword">const</span> resbuf*               entMask)</div><div class="line">{</div><div class="line">    acutPrintf(TEXT(<span class="stringliteral">&quot;beginSSGet:%s\n&quot;</span>), NULL != pPrompt ? pPrompt : TEXT(<span class="stringliteral">&quot;&quot;</span>));</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; points.length(); i++)</div><div class="line">        acutPrintf(TEXT(<span class="stringliteral">&quot;%d: %.2f, %.2f, %.2f\n&quot;</span>), i, points[i][X],</div><div class="line">        points[i][Y], points[i][Z]);</div><div class="line">}</div><div class="line"><span class="keywordtype">void</span></div><div class="line">    ZsdkContextReactor::endSSGet(</div><div class="line">    Acad::PromptStatus returnStatus,</div><div class="line">    <span class="keyword">const</span> AcArray&lt;AcDbObjectId&gt;&amp; ss)</div><div class="line">{</div><div class="line">    acutPrintf(TEXT(<span class="stringliteral">&quot;endSSGet\n&quot;</span>));</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ss.length(); i++)</div><div class="line">        acutPrintf(TEXT(<span class="stringliteral">&quot;Entity %d: &lt;%x&gt;\n&quot;</span>), i, ss[i].asOldId());</div><div class="line">}</div><div class="line"><span class="comment">// My context reactor object</span></div><div class="line">ZsdkContextReactor* Zsdk_cr = NULL;</div><div class="line"><span class="preprocessor">#if _ZWCAD</span></div><div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> __declspec(dllexport) AcRx::AppRetCode</div><div class="line">    zcrxEntryPoint(</div><div class="line">#<span class="keywordflow">else</span></div><div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> __declspec(dllexport) AcRx::AppRetCode</div><div class="line">    acrxEntryPoint(</div><div class="line">#endif</div><div class="line">    AcRx::AppMsgCode msg, </div><div class="line">    <span class="keywordtype">void</span> *p)</div><div class="line">{</div><div class="line">    <span class="keywordflow">switch</span> (msg)</div><div class="line">    {</div><div class="line">    <span class="keywordflow">case</span> AcRx::kInitAppMsg:</div><div class="line">        acrxUnlockApplication(p);</div><div class="line">        acrxRegisterAppMDIAware(p);</div><div class="line"></div><div class="line">        Zsdk_cr = <span class="keyword">new</span> ZsdkContextReactor();</div><div class="line">        curDoc()-&gt;inputPointManager()-&gt;</div><div class="line">            addInputContextReactor(Zsdk_cr);</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    <span class="keywordflow">case</span> AcRx::kLoadDwgMsg:</div><div class="line">        <span class="comment">// Attach a context reactor to the current document.</span></div><div class="line">        <span class="comment">//</span></div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    <span class="keywordflow">case</span> AcRx::kUnloadAppMsg:</div><div class="line">        <span class="comment">// Warning! This sample attaches a context reactor,</span></div><div class="line">        <span class="comment">// but it never detaches it. A real-life application </span></div><div class="line">        <span class="comment">// will need to monitor to which document it attached </span></div><div class="line">        <span class="comment">// the reactor, and will need to detach it.</span></div><div class="line">        <span class="comment">//</span></div><div class="line">        curDoc()-&gt;inputPointManager()-&gt;</div><div class="line">            removeInputContextReactor(Zsdk_cr);</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line">    <span class="keywordflow">return</span> AcRx::kRetOK;</div><div class="line">}</div></div><!-- fragment --> </div><!-- contents -->
<hr class="footer"/><address class="footer"><small>
<a href="https://www.zwsoft.com/zwcad/Developers/">
<img class="footer" src="../pics/zwsoft.png" alt="zwsoft"/></br>
</a>
&copy; 1998-2023  Copyright ZWSOFT CO., LTD(Guangzhou)</br>
All rights reserved.
</small></address>
</body>
</html>


